<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head th:replace="fragments :: head" />
<body>
	<div th:replace="fragments::index-navbar"></div>
	<div class="container text-center">
		<h1>Welcome to CrDr</h1>
	</div>
	<div class="container">
		<div class="row">
			<form th:action="@{/StoreCompany}"
				th:object="${CompanySelectCriteria}" method="post">
				<div class="col-xs-7 col-sm-6 col-lg-7">
					<fieldset>
						<legend>Company</legend>
						<div class="form-group col-xs-8">
							<select class="form-control" th:field="*{cid}" id="companies"
								name="accCode" size="10">
								<option th:each="company : ${companies}" th:value="${company}"
									th:text="${company}">WIREFRAME</option>
							</select>
						</div>
					</fieldset>
				</div>
				<div class="col-xs-7 col-sm-6 col-lg-7">
					<fieldset>
						<legend>Year</legend>
						<div class="form-group col-xs-8">
							<select class="form-control" th:field="*{cid}" id="accs"
								name="accCode" size="10">
								<option th:each="year : ${years.keySet()}" th:value="${key}"
									th:text="${years.get(key)}">WIREFRAME</option>
							</select>
						</div>
					</fieldset>
				</div>
			</form>
		</div>
		<script type="text/javascript">
   $(document).ready(function() {
    $("#companies").change(function() {
      var company = $(this).find(":selected").val();
      var json = {
       "companyName" : company
      };
 
      $.ajax({
       type : "POST",
       contentType : "application/json",
       url : "/loadyears",
       data : JSON.stringify(json),
       dataType : 'json',
       cache : false,
       timeout : 600000,
       success : function(data) {
        var html = '';
        var len = data.length;
        html += '<option value="0"></option>';
        for (var i = 0; i < len; i++) {
         html += '<option value="' + data[i].id + '">'
           + data[i].name
           + '</option>';
        }
        html += '</option>';
        $('#cityId').html(html);
       },
       error : function(e) {
        alert(e);
       }
      });
    });
   });
  </script>
	</div>
</body>
</html>